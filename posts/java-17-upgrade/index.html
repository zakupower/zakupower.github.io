<!doctype html><html lang=en><head><title>Migrating from Java 11 to 17 :: D. Tomov's Ramblings Repository</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Thoughts of migrating an application from Java 11 to Java 17"><meta name=keywords content="java-11,java-17,migration"><meta name=robots content="noodp"><link rel=canonical href=https://zakupower.github.io/posts/java-17-upgrade/><link rel=stylesheet href=/style.css><link rel="shortcut icon" href=https://zakupower.github.io/img/theme-colors/blue.png><link rel=apple-touch-icon href=https://zakupower.github.io/img/theme-colors/blue.png><meta name=twitter:card content="summary"><meta name=twitter:site content="https://zakupower.github.io"><meta name=twitter:creator content="Dimitar Tomov"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="og:title" content="Migrating from Java 11 to 17"><meta property="og:description" content="Thoughts of migrating an application from Java 11 to Java 17"><meta property="og:url" content="https://zakupower.github.io/posts/java-17-upgrade/"><meta property="og:site_name" content="D. Tomov's Ramblings Repository"><meta property="og:image" content="https://zakupower.github.io/img/favicon/blue.png"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><meta property="article:published_time" content="2022-11-08 19:01:49 +0200 +0200"></head><body class=blue><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/><div class=logo>D. Tomov</div></a></div><div class=menu-trigger>menu</div></div><nav class="menu hidden-on-mobile"><ul class="menu__inner menu__inner--desktop"><li><a href=/>/root</a></li><li><a href=/readme>README.md</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/>/root</a></li><li><a href=/readme>README.md</a></li></ul></nav></header><div class=content><article class=post><h1 class=post-title><a href=https://zakupower.github.io/posts/java-17-upgrade/>Migrating from Java 11 to 17</a></h1><div class=post-meta><time class=post-date>2022-11-08 ::</time>
<span class=post-author>Dimitar Tomov</span></div><span class=post-tags>#<a href=https://zakupower.github.io/tags/java/>java</a>&nbsp;
#<a href=https://zakupower.github.io/tags/experience/>experience</a>&nbsp;</span><div class=post-content><div><p>Today I had to migrate our application from Java 11 to Java 17. I think I should get into the habit of always googling stuff and not just thinking &ldquo;Yeah I know how to do it, I am going to be fine&rdquo;. This time I did google what issues might come from the upgrade and thankfully not too many. I followed <a href=https://dev.to/nix/migrating-a-project-from-java-11-to-java-17-a-step-by-step-guide-for-developers-42n>this guide by Nikita Zemnitsky @ NIX</a>, which does a pretty good job of explaining what issues might come up, so I am not going to list them here again.</p><h2 id=upgrade-your-libraries-frequently>Upgrade your libraries frequently<a href=#upgrade-your-libraries-frequently class=hanchor arialabel=Anchor>&#8983;</a></h2><p>The migration was super easy because my team has a good dependency hygiene and we have already upgraded the troublesome dependencies which were described in the guide long before this Java 17 upgrade. This is something I will be following religiously for all my projects from here on out! I have worked on a lot of different projects, but never have we kept our libraries so up-to-date, as in this one. Yes it is sometimes annoying when a library brakes something, but in the long run the application is way more healthy this way.</p><h2 id=maven-tests-issue>Maven tests issue<a href=#maven-tests-issue class=hanchor arialabel=Anchor>&#8983;</a></h2><p>After the migration, the only issue that was left out of the article by Nikita was that my tests weren&rsquo;t running. We were using the <code>maven-surefire-plugin</code> to run our tests under maven when building the application. This somehow was causing all our tests to fail with the following error:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Failed to execute goal org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>maven</span><span style=color:#f92672>.</span><span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>maven<span style=color:#f92672>-</span>surefire<span style=color:#f92672>-</span>plugin<span style=color:#f92672>:</span>2<span style=color:#f92672>.</span><span style=color:#a6e22e>22</span><span style=color:#f92672>.</span><span style=color:#a6e22e>2</span><span style=color:#f92672>:</span>test <span style=color:#f92672>(</span><span style=color:#66d9ef>default</span><span style=color:#f92672>-</span>test<span style=color:#f92672>)</span> on project Idlearn<span style=color:#f92672>:</span> Execution <span style=color:#66d9ef>default</span><span style=color:#f92672>-</span>test of goal org<span style=color:#f92672>.</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>.</span><span style=color:#a6e22e>maven</span><span style=color:#f92672>.</span><span style=color:#a6e22e>plugins</span><span style=color:#f92672>:</span>maven<span style=color:#f92672>-</span>surefire<span style=color:#f92672>-</span>plugin<span style=color:#f92672>:</span>2<span style=color:#f92672>.</span><span style=color:#a6e22e>22</span><span style=color:#f92672>.</span><span style=color:#a6e22e>2</span><span style=color:#f92672>:</span>test failed<span style=color:#f92672>:</span> Unsupported <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>file</span> major version 61 <span style=color:#f92672>-&gt;</span> <span style=color:#f92672>[</span>Help 1<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>Googling the error took me into a rabbit hole of getting the same response and that was &ldquo;You are compiling the tests with java 17, but trying to run them under a different version&rdquo;. Checking my maven setup multiple times with <code>mvn -version</code>, to make sure I have the right maven version, and it is using the correct java, and my JAVA_HOME path is correct. But it seemed like it was correct, but it was not working. After some time spent googling and trying different approaches, I finally stumbled on <a href=https://stackoverflow.com/questions/71496063/maven-surefire-test-failed-unsupported-class-file-major-version-61>this stack overflow question and answer</a>. So it turns out the newest version (2.22.2) of <code>maven-surefire-plugin</code>, that is not a Milestone version, has not upgraded some of its dependencies related to ASM. So you have to add the dependency to it manually. <em>(TBH didn&rsquo;t even know I could do that with plugins)</em></p><p>After this issue everything else went smoothly, all tests were green and the application was running!</p><h2 id=honorable-mentions>Honorable mentions<a href=#honorable-mentions class=hanchor arialabel=Anchor>&#8983;</a></h2><p>After the migration I decided to once again read <a href=https://mydeveloperplanet.com/2021/09/28/whats-new-between-java-11-and-java-17/>the article about what is new in Java 17 from 11</a>, but this time without skimming through it. Besides the new features there is also two very interesting things in the introduction.</p><h3 id=oraclejdk-17-is-free>OracleJDK 17 is free?<a href=#oraclejdk-17-is-free class=hanchor arialabel=Anchor>&#8983;</a></h3><blockquote><p>The Oracle licensing model has changed with the introduction of Java 17. Java 17 is issued under the new NFTC (Oracle No-Fee Terms and Conditions) license. It is therefore again allowed to use the Oracle JDK version for free for production and commercial use.</p></blockquote><p>So it turns out Oracle found out that hiding their JDK behind a paywall for production and commercial use, was such a huge mistake on their part, and they switched back to it being free.
It was only natural for most companies to start using a free alternative, when there is one available. Whenever a library or software becomes paid, the first question from my manager would be &ldquo;Is there a free alternative that does the same thing, and can be switched easily&rdquo;, and for JDK it was such an easy switch to OpenJDK.</p><h3 id=devjava>dev.java<a href=#devjava class=hanchor arialabel=Anchor>&#8983;</a></h3><p>I don&rsquo;t know how recent this is,but Oracle has created a cool little (lets hope only for now) <a href=https://dev.java/>website</a>. It has <strong>tutorials</strong> with topics ranging from basic java syntax to new java features. Also there is information about <strong>how you can contribute to Java</strong>, list of <strong>communities you can participate in</strong>, and information about <strong>future java projects</strong>.</p></div></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other commits</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://zakupower.github.io/posts/logging/><span class=button__icon>←</span>
<span class=button__text>Turns out Logging is hard</span></a></span>
<span class="button next"><a href=https://zakupower.github.io/posts/initial-commit/><span class=button__text>Initial Commit</span>
<span class=button__icon>→</span></a></span></div></div></article></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2022 Powered by <a href=http://gohugo.io>Hugo</a></span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/bundle.min.js></script></div></body></html>